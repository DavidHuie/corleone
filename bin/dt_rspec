#!/usr/bin/env ruby

require 'docker_test'
require 'docker_test/runner/rspec'

SERVER_URI = ENV['DOCKER_TEST_SERVER_URI'] || 'druby://localhost:7000'

runner = DockerTest::Runner::RSpec.get_runner(ARGV)
server = DockerTest::Server.new(runner, SERVER_URI)
server.start

loop do
  server.alive? ? sleep(1) : exit(0)
end
